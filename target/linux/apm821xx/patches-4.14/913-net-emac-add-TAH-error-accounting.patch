From 5ca2fd94c8e5f293c9f36ee0235d54680e237a2a Mon Sep 17 00:00:00 2001
From: Christian Lamparter <chunkeey@gmail.com>
Date: Sat, 20 Oct 2018 19:36:18 +0200
Subject: [PATCH 3/3] net: emac: add TAH error accounting

Signed-off-by: Christian Lamparter <chunkeey@gmail.com>
---
 drivers/net/ethernet/ibm/emac/emac.h | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

--- a/drivers/net/ethernet/ibm/emac/emac.h
+++ b/drivers/net/ethernet/ibm/emac/emac.h
@@ -275,6 +275,7 @@ struct emac_regs {
 #define EMAC_TX_CTRL_TAH_SSR0		0x0002
 
 /* EMAC specific TX descriptor status fields (read access) */
+#define EMAC_TX_ST_PE			0x0400
 #define EMAC_TX_ST_BFCS			0x0200
 #define EMAC_TX_ST_LCS			0x0080
 #define EMAC_TX_ST_ED			0x0040
@@ -287,8 +288,11 @@ struct emac_regs {
 #define EMAC_IS_BAD_TX			(EMAC_TX_ST_LCS | EMAC_TX_ST_ED | \
 					 EMAC_TX_ST_EC | EMAC_TX_ST_LC | \
 					 EMAC_TX_ST_MC | EMAC_TX_ST_UR)
-#define EMAC_IS_BAD_TX_TAH		(EMAC_TX_ST_LCS | EMAC_TX_ST_ED | \
-					 EMAC_TX_ST_EC | EMAC_TX_ST_LC)
+#define EMAC_IS_BAD_TX_TAH		(EMAC_TX_ST_PE | EMAC_TX_ST_LCS | \
+					 EMAC_TX_ST_ED | EMAC_TX_ST_EC | \
+					 EMAC_TX_ST_LC | EMAC_TX_ST_MC | \
+					 EMAC_TX_ST_SC | EMAC_TX_ST_UR | \
+					 EMAC_TX_ST_SQE)
 
 /* EMAC specific RX descriptor status fields (read access) */
 #define EMAC_RX_ST_OE			0x0200
